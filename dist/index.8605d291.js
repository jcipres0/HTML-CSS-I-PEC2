var t,e;t=this,e=function(){function t(t){if(!/^#([0-9a-f]{3}){1,2}$/i.test(t)&&!/^[a-z]+$/i.test(t))throw Error("Invalid color")}var e={},o=function(o,n,i,a){var s,l=this;r.library||"undefined"==typeof window||(r.library=window.mapboxgl||window.maplibregl||null);var c=r.library;if(!c)throw Error("No mapping library found");var p={},u={},f=[],d=0;function y(t){s.loaded()?t():s.on("load",t)}function m(t,e){t.textContent=e}function h(t,e,o,r){try{r(t,e,o)}catch(e){throw m(t,e.message),e}}function g(t,e,o,r){if("string"==typeof e){var n,i;n=function(e){h(t,e,o,r)},(i=new XMLHttpRequest).open("GET",e,!0),i.setRequestHeader("Content-Type","application/json"),i.onload=function(){200===i.status?n(JSON.parse(i.responseText)):m(t,i.statusText)},i.send()}else"function"==typeof e?e(function(e){h(t,e,o,r)},function(e){m(t,e)}):h(t,e,o,r)}function v(t,e,o){var r;r=function(){o.trail&&(x(e,o.trail),s.getSource("trails").setData(C(e))),s.getSource("objects").setData(w(e,o))},L?r():M.push(r)}(o=function(t){if("string"==typeof t){var e=t;if(!(t=document.getElementById(t)))throw Error("No element with id "+e)}return t}(o)).id&&(e[o.id]=this);var k=new window.Map;function w(e,o){for(var r={type:"FeatureCollection",features:[]},n=0;n<e.length;n++){var i=e[n],s=Object.assign({},i),l=void 0;if("point"===a){if(s.icon||(s.icon=o.defaultIcon||"mapkick"),s.mapkickIconSize="mapkick"===s.icon?.5:1,s.mapkickIconAnchor="mapkick"===s.icon?"bottom":"center",s.mapkickIconOffset="mapkick"===s.icon?[0,10]:[0,0],"mapkick"===s.icon){var c=s.color||j.color||"#f84d4d",p=k.get(c);void 0===p&&(p=k.size,t(c),k.set(c,p)),s.icon="mapkick-"+p}var u=b(i);if(!u[1])throw Error("missing latitude (index: "+n+")");if(!u[0])throw Error("missing longitude (index: "+n+")");l={type:"Point",coordinates:u}}else{if(!(l=i.geometry))throw Error("missing geometry (index: "+n+")");delete s.geometry,s.mapkickColor=s.color||j.color||"#0090ff"}r.features.push({type:"Feature",id:n,geometry:l,properties:s})}return r}function b(t){return[t.longitude||t.lng||t.lon,t.latitude||t.lat]}function x(t,e){for(var o=0;o<t.length;o++){var r=t[o],n=r.id;p[n]||(p[n]=[]),p[n].push(b(r)),e&&e.len&&p[n].length>e.len&&p[n].shift()}}function C(t){for(var e={type:"FeatureCollection",features:[]},o=0;o<t.length;o++){var r=t[o];e.features.push({type:"Feature",geometry:{type:"LineString",coordinates:p[r.id]}})}return e}function I(t,e){if("Point"===e.type)t.extend(e.coordinates);else if("Polygon"===e.type)for(var o=e.coordinates[0],r=0;r<o.length;r++)t.extend(o[r]);else if("MultiPolygon"===e.type)for(var n=e.coordinates,i=0;i<n.length;i++)for(var a=n[i][0],s=0;s<a.length;s++)t.extend(a[s])}var E=function(e,o,r){var n=w(o,r);r=r||{};for(var i=0;i<n.features.length;i++)I(O,n.features[i].geometry);e.textContent="";var p=r.style;if(!p){if(!("accessToken"in c)||/^1\.1[45]/.test(c.version))throw Error("style required for MapLibre");p="mapbox://styles/mapbox/streets-v12"}var u=r.zoom,f=r.center;f||(O.isEmpty()?(f=[0,0],u||(u=1)):f=O.getCenter()),u||(u=15);var d={container:e,style:p,dragRotate:!1,touchZoomRotate:!1,center:f,zoom:u};r.style||(d.projection="mercator"),r.accessToken&&(d.accessToken=r.accessToken),r.library&&Object.assign(d,r.library),s=new c.Map(d),r.controls&&s.addControl(new c.NavigationControl({showCompass:!1})),r.zoom||(s.style.stylesheet||(s.style.stylesheet={}),O.isEmpty()||s.getZoom()!==u||s.fitBounds(O,{padding:40,animate:!1,maxZoom:15})),l.map=s,y(function(){r.trail&&(x(o),s.addSource("trails",{type:"geojson",data:C([])}),s.addLayer({id:"trails",source:"trails",type:"line",layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":"#888","line-width":2}}));var e=k.size;function i(){var t;if(0!==e){e--;return}for(function(t,e){var o={};if(s.addSource(t,{type:"geojson",data:e}),"point"===a)s.addLayer({id:t+"-text",source:t,type:"symbol",layout:{"text-field":"{label}","text-size":11,"text-anchor":"top","text-offset":[0,1]},paint:{"text-halo-color":"rgba(255, 255, 255, 1)","text-halo-width":1}}),s.addLayer({id:t,source:t,type:"symbol",layout:{"icon-image":"{icon}-15","icon-allow-overlap":!0,"icon-size":{type:"identity",property:"mapkickIconSize"},"icon-anchor":{type:"identity",property:"mapkickIconAnchor"},"icon-offset":{type:"identity",property:"mapkickIconOffset"}}});else{var r=function(t){for(var e,o=t.getStyle().layers,r=o.length-1;r>=0;r--){var n=o[r];if(!(n.metadata&&"place-labels"===n.metadata["mapbox:featureComponent"]))break;e=n.id}return e}(s),n=t+"-outline";s.addLayer({id:n,source:t,type:"line",paint:{"line-color":{type:"identity",property:"mapkickColor"},"line-opacity":.7,"line-width":1}},r),s.addLayer({id:t,source:t,type:"fill",paint:{"fill-color":{type:"identity",property:"mapkickColor"},"fill-opacity":.3}},n);for(var i=t+"-text",l=function(t){for(var e={type:"FeatureCollection",features:[]},o=0;o<t.features.length;o++){var r=t.features[o],n=void 0,i=new c.LngLatBounds;if(I(i,r.geometry),!i.isEmpty()){var a=i.getCenter();n=[a.lng,a.lat]}n&&e.features.push({type:"Feature",id:o,geometry:{type:"Point",coordinates:n},properties:r.properties})}return e}(e),p=0;p<l.features.length;p++){var u=l.features[p];o[u.id]=u.geometry.coordinates}s.addSource(i,{type:"geojson",data:l}),s.addLayer({id:t+"-text",source:i,type:"symbol",layout:{"text-field":"{label}","text-size":11},paint:{"text-halo-color":"rgba(255, 255, 255, 1)","text-halo-width":1}})}var f=!("hover"in T)||T.hover,d={closeButton:!1,closeOnClick:!1};f||(d.anchor="bottom");var y=new c.Popup(d),m=function(t,e){var o=new DOMMatrixReadOnly(window.getComputedStyle(e.getElement()).transform),r=o.m42,n=o.m41;(r<5||n<5)&&t.panBy([Math.min(n-5-5,0),Math.min(r-5-5,0)])},h=function(t){var e,r=v(t),n=r.properties.tooltip;n&&("point"===a&&r.properties.icon.startsWith("mapkick-")?y.options.offset={top:[0,14],"top-left":[0,14],"top-right":[0,14],bottom:[0,-44],"bottom-left":[0,-44],"bottom-right":[0,-44],left:[14,0],right:[-14,0]}:y.options.offset=14,e="point"===a?r.geometry.coordinates:o[r.id],y.setLngLat(e),T.html?y.setHTML(n):y.setText(n),y.addTo(s),y._container.offsetWidth%2!=0&&(y._container.style.width=y._container.offsetWidth+1+"px"),"area"!==a&&m(s,y))},g=function(t){return t.geometry.coordinates[1]},v=function(t){for(var e=t.features,o=e[0],r=1;r<e.length;r++){var n=e[r];g(n)<g(o)&&(o=n)}return o};if(!f){var k=null;s.on("click",t,function(t){var e=v(t).id;e!==k&&(h(t),k=e,t.mapkickPopupOpened=!0)}),s.on("click",function(t){t.mapkickPopupOpened||(y.remove(),k=null)})}s.on("mouseenter",t,function(t){v(t).properties.tooltip&&(s.getCanvas().style.cursor="pointer",f&&h(t))}),s.on("mouseleave",t,function(){s.getCanvas().style.cursor="",f&&y.remove()})}("objects",n),L=!0;t=M.shift();)t()}k.forEach(function(e,o){var r=function(e,o){var r=new e.Marker()._element.querySelector("svg");r.removeAttribute("display"),r.setAttribute("xmlns","http://www.w3.org/2000/svg"),r.setAttribute("height",41),r.setAttribute("width",27),r.setAttribute("viewBox","0 0 27 41"),t(o),r.querySelector("*[fill='#3FB1CE']").setAttribute("fill",o);var n=r.querySelectorAll("circle"),i=n[n.length-1];if(1==n.length){var a=i.cloneNode();a.setAttribute("fill","#000000"),a.setAttribute("opacity",.25),i.parentNode.insertBefore(a,i)}i.setAttribute("r",4.5);var s=new Image(54,82);return s.src="data:image/svg+xml;utf8,"+encodeURIComponent(r.outerHTML),s}(c,o);r.addEventListener("load",function(){s.addImage("mapkick-"+e+"-15",r),i()})}),i()})},L=!1,M=[];i=i||{};var T=(i=Object.assign({},r.options,i)).tooltips||{},j=i.markers||{},O=new c.LngLatBounds;i.replay?g(o,n,i,function(t,e,o){for(var r=0;r<e.length;r++){var n,i=e[r],a="number"==typeof(n=i.time)?n:new Date(n).getTime()/1e3;a&&(u[a]||(u[a]=[]),u[a].push(i),O.extend(b(i)))}for(var s in u)Object.prototype.hasOwnProperty.call(u,s)&&f.push(parseInt(s));f.sort(),E(t,u[f[d]],o),y(function(){setTimeout(function(){(function t(e,o){v(e,u[f[++d]],o),d<f.length-1&&setTimeout(function(){t(e,o)},100)})(t,o)},100)})}):(g(o,n,i,E),i.refresh&&(this.intervalId=setInterval(function(){g(o,n,i,v)},1e3*i.refresh)))};o.prototype.getMapObject=function(){return this.map},o.prototype.destroy=function(){this.stopRefresh(),this.map&&(this.map.remove(),this.map=null)},o.prototype.stopRefresh=function(){this.intervalId&&(clearInterval(this.intervalId),this.intervalId=null)};var r={Map:/*@__PURE__*/function(t){function e(e,o,r){t.call(this,e,o,r,"point")}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(o),AreaMap:/*@__PURE__*/function(t){function e(e,o,r){t.call(this,e,o,r,"area")}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(o),maps:e,options:{},library:null};return r.use=function(t){r.library=t},"undefined"==typeof window||window.Mapkick||(window.Mapkick=r,setTimeout(function(){window.dispatchEvent(new Event("mapkick:load"))},0)),r},"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).Mapkick=e();
//# sourceMappingURL=index.8605d291.js.map
